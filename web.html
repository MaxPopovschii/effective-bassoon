<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crypto API Tester</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    input, select, button { margin: 0.2em; }
    .result { background: #f0f0f0; padding: 1em; margin-top: 1em; }
    .section { border: 1px solid #ccc; padding: 1em; margin-bottom: 2em; }
    h2 { margin-top: 0; }
  </style>
</head>
<body>
  <h1>Crypto API Tester</h1>

  <div class="section">
    <h2>/crypto</h2>
    <input id="crypto-msg" placeholder="Message">
    <select id="crypto-algo">
      <option value="base64">base64</option>
      <option value="md5">md5</option>
      <option value="sha256">sha256</option>
      <option value="aes">aes</option>
    </select>
    <select id="crypto-action">
      <option value="encode">encode</option>
      <option value="decode">decode</option>
    </select>
    <input id="crypto-key" placeholder="AES key (32 chars)">
    <button onclick="callCrypto()">Test</button>
    <div id="crypto-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/hmac</h2>
    <input id="hmac-msg" placeholder="Message">
    <input id="hmac-key" placeholder="Key">
    <button onclick="callHmac()">Test</button>
    <div id="hmac-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/password</h2>
    <input id="password-length" type="number" value="16" min="8" max="64">
    <button onclick="callPassword()">Generate</button>
    <div id="password-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/salt</h2>
    <input id="salt-length" type="number" value="16" min="8" max="64">
    <button onclick="callSalt()">Generate</button>
    <div id="salt-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/jwt/generate & /jwt/validate</h2>
    <input id="jwt-username" placeholder="Username">
    <button onclick="callJwtGenerate()">Generate JWT</button>
    <input id="jwt-token" placeholder="JWT Token" style="width: 60%;">
    <button onclick="callJwtValidate()">Validate JWT</button>
    <div id="jwt-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/verify-hash</h2>
    <input id="verify-msg" placeholder="Message">
    <input id="verify-hash" placeholder="Hash">
    <select id="verify-algo">
      <option value="md5">md5</option>
      <option value="sha256">sha256</option>
    </select>
    <button onclick="callVerifyHash()">Verify</button>
    <div id="verify-result" class="result"></div>
  </div>

  <div class="section">
    <h2>/rsa/encrypt & /rsa/decrypt & /rsa/public</h2>
    <input id="rsa-msg" placeholder="Message">
    <button onclick="callRsaEncrypt()">Encrypt</button>
    <input id="rsa-cipher" placeholder="Ciphertext" style="width: 60%;">
    <button onclick="callRsaDecrypt()">Decrypt</button>
    <button onclick="callRsaPublic()">Show Public Key</button>
    <div id="rsa-result" class="result"></div>
  </div>

  <script>
    const api = (path, params) =>
      fetch(path + '?' + new URLSearchParams(params))
        .then(r => r.json())
        .catch(e => ({ error: e.toString() }));

    function callCrypto() {
      const msg = document.getElementById('crypto-msg').value;
      const algo = document.getElementById('crypto-algo').value;
      const action = document.getElementById('crypto-action').value;
      const key = document.getElementById('crypto-key').value;
      api('/crypto', { msg, algo, action, key }).then(res =>
        document.getElementById('crypto-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callHmac() {
      const msg = document.getElementById('hmac-msg').value;
      const key = document.getElementById('hmac-key').value;
      api('/hmac', { msg, key }).then(res =>
        document.getElementById('hmac-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callPassword() {
      const length = document.getElementById('password-length').value;
      api('/password', { length }).then(res =>
        document.getElementById('password-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callSalt() {
      const length = document.getElementById('salt-length').value;
      api('/salt', { length }).then(res =>
        document.getElementById('salt-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callJwtGenerate() {
      const username = document.getElementById('jwt-username').value;
      api('/jwt/generate', { username }).then(res => {
        document.getElementById('jwt-result').textContent = JSON.stringify(res, null, 2);
        if (res.jwt) document.getElementById('jwt-token').value = res.jwt;
      });
    }

    function callJwtValidate() {
      const token = document.getElementById('jwt-token').value;
      api('/jwt/validate', { token }).then(res =>
        document.getElementById('jwt-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callVerifyHash() {
      const msg = document.getElementById('verify-msg').value;
      const hash = document.getElementById('verify-hash').value;
      const algo = document.getElementById('verify-algo').value;
      api('/verify-hash', { msg, hash, algo }).then(res =>
        document.getElementById('verify-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callRsaEncrypt() {
      const msg = document.getElementById('rsa-msg').value;
      api('/rsa/encrypt', { msg }).then(res => {
        document.getElementById('rsa-result').textContent = JSON.stringify(res, null, 2);
        if (res.output) document.getElementById('rsa-cipher').value = res.output;
      });
    }

    function callRsaDecrypt() {
      const msg = document.getElementById('rsa-cipher').value;
      api('/rsa/decrypt', { msg }).then(res =>
        document.getElementById('rsa-result').textContent = JSON.stringify(res, null, 2)
      );
    }

    function callRsaPublic() {
      api('/rsa/public', {}).then(res =>
        document.getElementById('rsa-result').textContent = JSON.stringify(res, null, 2)
      );
    }
  </script>
</body>
</html>